import{a as e,Y as o,Z as t,a0 as a,a1 as n,a6 as i,u as r,c as s,F as l,a7 as c,a2 as p,a8 as d,D as u,o as m,j as y,a9 as f,w as g,m as h,_ as v,aa as C,r as w,E as _}from"../@vue/@vue.591b34be.js";import{b as A,u as j}from"../vue-router/vue-router.7b106eff.js";import{_ as b}from"../_plugin-vue_export-helper/_plugin-vue_export-helper.1b428a4d.js";import{a5 as S}from"../@ant-design/@ant-design.8e5bd72a.js";import{u as M}from"../map/map.1cb73870.js";import{S as k,G as L,L as x,C as I,P as O}from"../@antv/@antv.cba7c19b.js";import"../lodash/lodash.175d8967.js";import"../eventemitter3/eventemitter3.6f8d8fe8.js";import{b as B,e as E}from"../@turf/@turf.cb876624.js";import{s as T}from"../pinia/pinia.84e91d01.js";import"../@ctrl/@ctrl.4982d949.js";import"../@amap/@amap.09f500c0.js";import"../@mapbox/@mapbox.4a2ba10c.js";import"../pbf/pbf.7d22906b.js";import"../ieee754/ieee754.153d16be.js";import"../supercluster/supercluster.5ccdcb43.js";import"../@babel/@babel.59141994.js";import"../viewport-mercator-project/viewport-mercator-project.0153e00c.js";import"../gl-matrix/gl-matrix.30ed328e.js";import"../d3-array/d3-array.375ae530.js";import"../d3-scale/d3-scale.6e57d274.js";import"../d3-collection/d3-collection.24c9e70d.js";import"../d3-format/d3-format.556ed624.js";import"../d3-time-format/d3-time-format.fb31d540.js";import"../d3-time/d3-time.77eb7812.js";import"../d3-interpolate/d3-interpolate.152deb5d.js";import"../d3-color/d3-color.050db9d2.js";import"../earcut/earcut.b5948046.js";import"../tslib/tslib.641abe3b.js";import"../regl/regl.7d4a0338.js";import"../d3-dsv/d3-dsv.11e1db92.js";import"../geojson-vt/geojson-vt.cda43fa5.js";import"../hammerjs/hammerjs.1332a10d.js";import"../element-resize-detector/element-resize-detector.eb3fc9f8.js";import"../batch-processor/batch-processor.06abf2b4.js";import"../d3-hexbin/d3-hexbin.f182805f.js";import"../polygon-clipping/polygon-clipping.9976feed.js";import"../splaytree/splaytree.e3fd5a63.js";import"../vue-demi/vue-demi.71ba0ef2.js";const D={homeTitle:"可视化平台"},P={class:"menu-container"},G={class:"logo"},z={class:"search"},R={class:"menu"},F=["onClick"],Y={class:"author"},J=b({__name:"LayoutMenu",setup(m){const y=A(),f=j(),g=e({current:{},options:[],handleChange(e){}}),h=e({options:[{label:"大屏展示",route:"/overview"}],onClickMenu(e){f.replace({path:e.route})}});return(e,m)=>{const f=o("a-select"),v=o("a-avatar"),C=o("a-badge");return t(),a("div",P,[n("div",G,i(r(D).homeTitle),1),n("div",z,[s(f,{value:r(g).value,"onUpdate:value":m[0]||(m[0]=e=>r(g).value=e),mode:"tags",style:{width:"100%"},placeholder:"请输入",options:r(g).options,onChange:r(g).handleChange},null,8,["value","options","onChange"])]),n("div",R,[(t(!0),a(l,null,c(r(h).options,(e=>(t(),a("div",{class:d(["menu-item",{active:r(y).path===e.route}]),key:e.route,onClick:u((o=>r(h).onClickMenu(e)),["stop"])},i(e.label),11,F)))),128))]),n("div",Y,[s(C,{dot:""},{default:p((()=>[s(v,null,{icon:p((()=>[s(r(S))])),_:1})])),_:1})])])}}},[["__scopeId","data-v-c8465676"]]);const N=b({},[["render",function(e,o){return null}]]),V={id:"map-container"},W=b({__name:"map2d-base",props:{id:{type:String,default:"main"}},setup(e){const o=M();return m((async()=>{window.map=await new AMap.Map("map-container",{viewMode:"3D",zoom:4,center:[104.2990125,28.480215434999998],resizeEnable:!0}),map.setMapStyle("amap://styles/dark"),window.scene=new k({id:"map-container",map:new L({mapInstance:window.map})}),AMap.plugin(["AMap.ToolBar","AMap.Scale","AMap.HawkEye","AMap.MapType","AMap.Geolocation","AMap.ControlBar"],(function(){map.addControl(new AMap.Scale)})),o.contextMenu=new AMap.ContextMenu,map.on("rightclick",(function(e){})),map.on("complete",(function(){o.mapLoadStatus=!0}))})),y((async()=>{map&&map.destroy()})),(e,o)=>(t(),a("div",V))}},[["__scopeId","data-v-560b3289"]]),U={class:"map-layout"},Z={class:"map-components"},K=b({__name:"map2d-layout",props:{id:{type:String,default:"main"}},setup:e=>(o,i)=>(t(),a("div",U,[s(W,{id:e.id},null,8,["id"]),n("div",Z,[f(o.$slots,"default",{},void 0,!0)])]))},[["__scopeId","data-v-e368c412"]]),Q={__name:"FitView",setup(e){const o=M();return g((()=>o.flyArea),(e=>{e&&function(e){if(!e)return;const[o,{lng:t,lat:a}]=map.getFitZoomAndCenterByBounds(B(e));map.setZoomAndCenter(o-.5,[t,a])}(e)}),{immediate:!0}),(e,o)=>null}},H=b({__name:"CascaderArea2d",setup(e){const o=M();let t=null;function a(e){!function(e){AMap.plugin("AMap.GeoJSON",(function(){t=new AMap.GeoJSON({zoomToExtent:!0,geoJSON:e,getMarker:function(e,o){const{properties:t}=e;return new AMap.Marker({position:o,offset:new AMap.Pixel(-10,-10),title:null==t?void 0:t.name})},getPolyline:function(e,o){return new AMap.Polyline({path:o})},getPolygon:function(e,t){const a=new AMap.Polygon({path:t,fillOpacity:0,strokeColor:"gray",fillColor:"white",fitView:!0});return a.on("mouseover",(()=>{a.setOptions({fillOpacity:.7,fillColor:"white"})})),a.on("click",(()=>{const t=[...e.properties.acroutes,Number(e.properties.adcode)];t.length>o.cascader_max_level?alert("已达到最大层级"):o.cascader_vmodel=t})),a.on("mouseout",(()=>{a.setOptions({fillOpacity:0,fillColor:"#white"})})),a}}),map.add(t)}))}(e)}return g((()=>o.cascaer_geo_data),(e=>{if(!e)return null==t||t.clearOverlays(),void(t=null);t?t.importData(e):a(e),o.flyArea=e}),{immediate:!0,deep:!0}),(e,o)=>null}},[["__scopeId","data-v-8c67130e"]]),q=b({__name:"ImgCluster2d",setup(e){M();var o=new AMap.Marker({position:[114.3,30.59],content:'\n        <img\n            width="50px"\n            height="50px"\n            src="https://img.zcool.cn/community/01a3a2599c3deba80121ad7b597cab.jpg@1280w_1l_2o_100sh.jpg"\n        />\n    ',offset:new AMap.Pixel(-13,-30)});return map.add(o),m((()=>{})),(e,o)=>null}},[["__scopeId","data-v-e368fb2e"]]),X={__name:"LineWall2d",props:{id:{type:String,default:"",require:!0}},setup(e){const o=M();let t;const a=e;return m((async()=>{let e=await _api.getGeojsonById(a.id);o.flyArea=e,t=new x({}).source(e).size(40).shape("wall").style({opacity:1,sourceColor:"#0DCCFF",targetColor:"rbga(255,255,255, 0)"}),scene.addLayer(t)})),h((()=>{scene.removeLayer(t)})),(e,o)=>null}},$={__name:"CircularSweepingCity",setup(e){const o=M();let t,a,n,i,r;return m((()=>{fetch("https://gw.alipayobjects.com/os/rmsportal/ggFwDClGjjvpSMBIrcEx.json").then((async e=>{let a=await e.json();o.flyArea=a,t=new I,t.source(a).size("floor",[0,500]).color("rgba(242,246,250,1.0)").animate({enable:!0}).active({color:"#0ff",mix:.5}).style({opacity:.7,baseColor:"rgb(16, 16, 16)",windowColor:"rgb(30, 60, 89)",brightColor:"rgb(255, 176, 38)",sweep:{enable:!0,sweepRadius:2,sweepColor:"#1990FF",sweepSpeed:.5,sweepCenter:[120.145319,30.238915]}}),scene.addLayer(t)})),fetch("https://gw.alipayobjects.com/os/bmw-prod/67130c6c-7f49-4680-915c-54e69730861d.json").then((e=>e.json())).then((({lakeBorderData:e,lakeData:o,landData:t})=>{a=(new O).source(o).shape("fill").color("#1E90FF").style({opacity:.4,opacityLinear:{enable:!0,dir:"out"}}),n=(new O).source(t).shape("fill").color("#3CB371").style({opacity:.4,opacityLinear:{enable:!0,dir:"in"}}),i=(new O).source(e).shape("fill").color("#ccc").style({opacity:.5,opacityLinear:{enable:!0,dir:"in"}}),scene.addLayer(a),scene.addLayer(i),scene.addLayer(n)})),fetch("https://gw.alipayobjects.com/os/basement_prod/40ef2173-df66-4154-a8c0-785e93a5f18e.json").then((e=>e.json())).then((e=>{r=new x({zIndex:0,depth:!0}).source(e).size(1).shape("line").color("#1990FF").animate({interval:3,duration:3,trailLength:2}),scene.addLayer(r)}))})),h((()=>{t&&scene.removeLayer(t),a&&scene.removeLayer(a),n&&scene.removeLayer(n),i&&scene.removeLayer(i),r&&scene.removeLayer(r)})),(e,o)=>null}},ee={__name:"index",setup(e){const o=M(),{checkedLayerList:n}=T(o);return(e,o)=>(t(),a(l,null,[r(n).includes("imgcluster")?(t(),v(q,{key:0,id:"imgcluster"})):C("",!0),r(n).includes("CircularSweepingCity")?(t(),v($,{key:1,id:"CircularSweepingCity"})):C("",!0),r(n).includes("LineWall")?(t(),v(X,{key:2,id:"LineWall"})):C("",!0)],64))}},oe={__name:"index",setup(e){const n=M();return(e,i)=>{const c=o("router-view");return t(),a(l,null,[r(n).mapLoadStatus?(t(),v(c,{key:0})):C("",!0),s(K,null,{default:p((()=>[r(n).mapLoadStatus?(t(),a(l,{key:0},[s(H),s(ee),s(Q)],64)):C("",!0)])),_:1})],64)}}},te=b({__name:"map3d-base",setup(e){let o;Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyMGZjMTZjMC00YTQ4LTQwODAtOTg5YS1lOWU2NThjMTk0YjMiLCJpZCI6MjExNTEwLCJpYXQiOjE3MTQxMjIzNDZ9.o5yDodfaExKiDdc9mN0N86ybB3l2K4ggAThC3SWURkE";const n=w(null),i=M();return m((async()=>{o=new Cesium.Viewer(n.value,{baseLayerPicker:!0,homeButton:!1,infoBox:!1,fullscreenButton:!1,timeline:!1,animation:!1,geocoder:!1,navigationHelpButton:!1}),window.viewer=o,o._cesiumWidget._creditContainer.style.display="none",o._cesiumWidget._creditContainer&&(o._cesiumWidget._creditContainer.style.display="none"),o.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(114.3,30.59,8e6),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0,distance:1e3}}),function(e){const o=new Cesium.ScreenSpaceEventHandler(e.scene.canvas);o.setInputAction((function(o){var t;const a=e.scene.pick(o.position);null==(t=null==a?void 0:a.id)||t.billboard}),Cesium.ScreenSpaceEventType.LEFT_CLICK),o.setInputAction((function(o){var t;const a=e.scene.pick(o.endPosition),n=_tool.isEmpty(null==(t=null==a?void 0:a.id)?void 0:t.billboard);document.body.style.cursor=n?"default":"pointer"}),Cesium.ScreenSpaceEventType.MOUSE_MOVE)}(o),i.mapLoadStatus=!0})),_((function(){o&&o.destroy()})),(e,o)=>(t(),a("div",{ref_key:"cesiumContainer",ref:n,class:"cesium-container"},null,512))}},[["__scopeId","data-v-54fb4912"]]),ae={class:"map-layout"},ne={class:"map-components"},ie=b({__name:"map3d-layout",setup:e=>(e,o)=>(t(),a("div",ae,[s(te),n("div",ne,[f(e.$slots,"default",{},void 0,!0)])]))},[["__scopeId","data-v-c565f954"]]),re={__name:"Camera",setup(e){const o=M(),{flyPoi:t,flyArea:a}=T(o);return g(t,(e=>{const{x:o,y:t,z:a,opt:n={}}=e;o&&t&&a&&viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(o,t,a),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0,distance:1e3,...n}})})),g(a,(e=>{const o=new Cesium.GeoJsonDataSource;o.load(e).then((()=>{viewer.dataSources.add(o);const t=E(e),a=viewer.camera.createFlightPath({destination:t,orientation:{heading:Cesium.Math.toRadians(270),pitch:Cesium.Math.toRadians(-60),roll:0},duration:2});viewer.camera.flyTo(a)}))})),(e,o)=>null}},se={__name:"RandomPointLayer",props:{id:{type:String,default:"",require:!0}},setup(e){let o=null;const t=e;return h((()=>{viewer.dataSources.remove(o),o=null})),m((async()=>{!function(e){let t=Cesium.GeoJsonDataSource.load(e);viewer.dataSources.add(t).then((function(e){o=e;let t=e.entities.values;for(let o=0;o<t.length;o++){let e=t[o];e.billboard.color=Cesium.Color.fromCssColorString("#fff"),e.billboard.image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPdJREFUOE+tk+FtwjAQhe85DAB0gSBh1iBsQn4mDAEMUfIzbJJ0ikqkElmgaSfwQ3YICBRKmvZ+WfK7z767d5A/Btryx0mxFoEv5FKEpUDlMObtczXb3+tvAMPk3Vf0MpfcGiwNEH5HOm+uL4BhUgSKkj2v6BZyAYx2RQaR4DnAKlhW8WxiTw7w8npYEki7JZ9VkE0V6a0DjJOPtG5Y96BI/hXrRQ3YHY6PG/cIWpfhAL+r/wqsYo3+AGBfRdOwdxNBhtZYDmANBA7S3mNsIIqDY5c5GMiiceP/Wbl52ZbjGS+gUnOSPoS+XSbnvkhvf1ymLt+/15wAWdRtER3S2c8AAAAASUVORK5CYII="}}))}(await _api.getGeojsonById(t.id))})),(e,o)=>null}},le={__name:"RandomPolygonLayer",props:{id:{type:String,default:"",require:!0}},setup(e){M();let o=null;const t=e;return h((()=>{viewer.dataSources.remove(o),o=null})),m((async()=>{!function(e,t=!0){const a=window.viewer;o=new Cesium.GeoJsonDataSource;let n=new Map;o.load(e,{clampToGround:!0}).then((e=>{a.dataSources.add(o),a.zoomTo(o),o.entities.values.forEach(((e,o)=>{e.polygon.material=Cesium.Color.fromCssColorString("#fff").withAlpha(0),e.polyline={positions:e.polygon.hierarchy._value.positions,width:3,material:Cesium.Color.fromCssColorString("#689fd2")};const t=Cesium.BoundingSphere.fromPoints(e.polygon.hierarchy._value.positions).center,a=e.properties.getValue().name;n.get(a)||(e.label={text:a,color:Cesium.Color.fromCssColorString("#fff"),font:"normal 32px MicroSoft YaHei",showBackground:!0,scale:.5,horizontalOrigin:Cesium.HorizontalOrigin.LEFT_CLICK,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,disableDepthTestDistance:1e4,enableCollisionDetection:!0},n.set(a,1)),e.position=t}))}))}(await t.id)})),(e,o)=>null}},ce={__name:"index",setup(e){const o=M(),{checkedLayerList:n}=T(o);return(e,o)=>(t(),a(l,null,[r(n).includes("randomPoint")?(t(),v(se,{key:0,id:"randomPoint"})):C("",!0),r(n).includes("randomPolygon")?(t(),v(le,{key:1,id:"randomPolygon"})):C("",!0)],64))}},pe={__name:"CascaderArea3d",setup(e){const o=M();let n=null;return g((()=>o.cascaer_geo_data),(e=>{var t;e&&(n&&((t=n)&&window.viewer.dataSources.remove(t)),n=function(e,t=!0){const a=window.viewer,n=new Cesium.GeoJsonDataSource;let i=new Map;return n.load(e,{clampToGround:!0}).then((t=>{var r;a.dataSources.add(n),n.entities.values.forEach(((e,o)=>{e.polygon.material=Cesium.Color.fromCssColorString("#fff").withAlpha(0),e.polyline={positions:e.polygon.hierarchy._value.positions,width:3,material:Cesium.Color.fromCssColorString("#689fd2")};const t=Cesium.BoundingSphere.fromPoints(e.polygon.hierarchy._value.positions).center,a=e.properties.getValue().name;i.get(a)||(e.label={text:a,color:Cesium.Color.fromCssColorString("#fff"),font:"normal 32px MicroSoft YaHei",showBackground:!0,scale:.5,horizontalOrigin:Cesium.HorizontalOrigin.LEFT_CLICK,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,disableDepthTestDistance:1e4,enableCollisionDetection:!0},i.set(a,1)),e.position=t}));const s=[1e7,1e6,8e5][(null==(r=o.cascader_vmodel)?void 0:r.length)-1],[l,c]=E(e).geometry.coordinates;o.flyPoi={x:l,y:c,z:s}})),n}(e))}),{immediate:!0,deep:!0}),(e,o)=>(t(),a("div"))}},de={__name:"index",setup(e){const n=M();return(e,i)=>{const c=o("router-view");return t(),a(l,null,[r(n).mapLoadStatus?(t(),v(c,{key:0})):C("",!0),s(ie,null,{default:p((()=>[s(pe),s(re),s(ce)])),_:1})],64)}}},ue={class:"layout"},me={class:"layout-header"},ye={class:"layout-content"},fe=b({__name:"Layout",setup(e){const o=M();return(e,i)=>(t(),a("div",ue,[n("div",me,[s(J)]),n("div",ye,["2d"==r(o).mapMode?(t(),v(oe,{key:0})):C("",!0),"3d"==r(o).mapMode?(t(),v(de,{key:1})):C("",!0)]),s(N)]))}},[["__scopeId","data-v-604494c5"]]);export{fe as default};
