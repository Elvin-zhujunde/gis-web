import{d as e,u as t,o as n,c as a,M as o,S as i,y as r,H as s,K as l,U as u,N as c,V as d,W as p,X as m,b as f,Y as y,Z as g,w as v,v as h,_,r as C,s as w}from"./ant-design-vue-15b822e0.js";import{a as M,u as b,s as k}from"./index-4b8b9c1f.js";import{_ as S}from"./_plugin-vue_export-helper-1b428a4d.js";import{u as A}from"./map-eacbfc02.js";import"./lodash-es-3548b15e.js";const I={homeTitle:"可视化平台"},T={class:"menu-container"},x={class:"logo"},O={class:"search"},P={class:"menu"},E=["onClick"],L={class:"author"},j=S({__name:"LayoutMenu",setup(f){const y=M(),g=b(),v=e({current:{},options:[],handleChange(e){}}),h=e({options:[{label:"大屏展示",route:"/overview"}],onClickMenu(e){g.replace({path:e.route})}});return(e,f)=>{const g=t("a-select"),_=t("a-avatar"),C=t("a-badge");return n(),a("div",T,[o("div",x,i(r(I).homeTitle),1),o("div",O,[s(g,{value:r(v).value,"onUpdate:value":f[0]||(f[0]=e=>r(v).value=e),mode:"tags",style:{width:"100%"},placeholder:"请输入",options:r(v).options,onChange:r(v).handleChange},null,8,["value","options","onChange"])]),o("div",P,[(n(!0),a(l,null,u(r(h).options,(e=>(n(),a("div",{class:p(["menu-item",{active:r(y).path===e.route}]),key:e.route,onClick:m((t=>r(h).onClickMenu(e)),["stop"])},i(e.label),11,E)))),128))]),o("div",L,[s(C,{dot:""},{default:c((()=>[s(_,null,{icon:c((()=>[s(r(d))])),_:1})])),_:1})])])}}},[["__scopeId","data-v-c8465676"]]);const D=S({},[["render",function(e,t){return null}]]),N={id:"map-container"},B=S({__name:"map2d-base",props:{id:{type:String,default:"main"}},setup(e){const t=A();return f((async()=>{window.map=await new AMap.Map("map-container",{viewMode:"3D",zoom:4,center:[104.2990125,28.480215434999998],resizeEnable:!0}),map.setMapStyle("amap://styles/dark"),AMap.plugin(["AMap.ToolBar","AMap.Scale","AMap.HawkEye","AMap.MapType","AMap.Geolocation","AMap.ControlBar"],(function(){map.addControl(new AMap.Scale)})),t.contextMenu=new AMap.ContextMenu,map.on("rightclick",(function(e){})),map.on("complete",(function(){t.mapLoadStatus=!0}))})),y((async()=>{map&&map.destroy()})),(e,t)=>(n(),a("div",N))}},[["__scopeId","data-v-eb8a1267"]]),G={class:"map-layout"},J={class:"map-components"},z=S({__name:"map2d-layout",props:{id:{type:String,default:"main"}},setup:e=>(t,i)=>(n(),a("div",G,[s(B,{id:e.id},null,8,["id"]),o("div",J,[g(t.$slots,"default",{},void 0,!0)])]))},[["__scopeId","data-v-e368c412"]]);function R(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function F(e,t,n){if(null!==e)for(var a,o,i,r,s,l,u,c,d=0,p=0,m=e.type,f="FeatureCollection"===m,y="Feature"===m,g=f?e.features.length:1,v=0;v<g;v++){s=(c=!!(u=f?e.features[v].geometry:y?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var h=0;h<s;h++){var _=0,C=0;if(null!==(r=c?u.geometries[h]:u)){l=r.coordinates;var w=r.type;switch(d=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===t(l,p,v,_,C))return!1;p++,_++;break;case"LineString":case"MultiPoint":for(a=0;a<l.length;a++){if(!1===t(l[a],p,v,_,C))return!1;p++,"MultiPoint"===w&&_++}"LineString"===w&&_++;break;case"Polygon":case"MultiLineString":for(a=0;a<l.length;a++){for(o=0;o<l[a].length-d;o++){if(!1===t(l[a][o],p,v,_,C))return!1;p++}"MultiLineString"===w&&_++,"Polygon"===w&&C++}"Polygon"===w&&_++;break;case"MultiPolygon":for(a=0;a<l.length;a++){for(C=0,o=0;o<l[a].length;o++){for(i=0;i<l[a][o].length-d;i++){if(!1===t(l[a][o][i],p,v,_,C))return!1;p++}C++}_++}break;case"GeometryCollection":for(a=0;a<r.geometries.length;a++)if(!1===F(r.geometries[a],t,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function U(e){var t=[Infinity,Infinity,-Infinity,-Infinity];return F(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}function V(e,t){void 0===t&&(t={});var n=U(e);return function(e,t,n){if(void 0===n&&(n={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!R(e[0])||!R(e[1]))throw new Error("coordinates must contain numbers");return function(e,t,n){void 0===n&&(n={});var a={type:"Feature"};return(0===n.id||n.id)&&(a.id=n.id),n.bbox&&(a.bbox=n.bbox),a.properties=t||{},a.geometry=e,a}({type:"Point",coordinates:e},t,n)}([(n[0]+n[2])/2,(n[1]+n[3])/2],t.properties,t)}U.default=U;const W=S({__name:"CascaderArea2d",setup(e){const t=A();let n=null;function a(e){!function(e){AMap.plugin("AMap.GeoJSON",(function(){n=new AMap.GeoJSON({zoomToExtent:!0,geoJSON:e,getMarker:function(e,t){const{properties:n}=e;return new AMap.Marker({position:t,offset:new AMap.Pixel(-10,-10),title:null==n?void 0:n.name})},getPolyline:function(e,t){return new AMap.Polyline({path:t})},getPolygon:function(e,n){const a=new AMap.Polygon({path:n,fillOpacity:0,strokeColor:"gray",fillColor:"white",fitView:!0});return a.on("mouseover",(()=>{a.setOptions({fillOpacity:.7,fillColor:"white"})})),a.on("click",(()=>{const n=[...e.properties.acroutes,Number(e.properties.adcode)];n.length>t.cascader_max_level?alert("已达到最大层级"):t.cascader_vmodel=n})),a.on("mouseout",(()=>{a.setOptions({fillOpacity:0,fillColor:"#white"})})),a}}),map.add(n)}))}(e)}return v((()=>t.cascaer_geo_data),(e=>{if(!e)return null==n||n.clearOverlays(),void(n=null);n?n.importData(e):a(e),function(e){if(!e)return;const[t,{lng:n,lat:a}]=map.getFitZoomAndCenterByBounds(U(e));map.setZoomAndCenter(t-.5,[n,a])}(e)}),{immediate:!0,deep:!0}),(e,t)=>null}},[["__scopeId","data-v-a1170bbc"]]),Z=S({__name:"ImgCluster2d",setup(e){A();var t=new AMap.Marker({position:[114.3,30.59],content:'\n        <img\n            width="50px"\n            height="50px"\n            src="https://img.zcool.cn/community/01a3a2599c3deba80121ad7b597cab.jpg@1280w_1l_2o_100sh.jpg"\n        />\n    ',offset:new AMap.Pixel(-13,-30)});return map.add(t),f((()=>{})),(e,t)=>null}},[["__scopeId","data-v-e368fb2e"]]),H={__name:"index",setup(e){const t=A(),{checkedLayerList:a}=k(t);return(e,t)=>r(a).includes("imgcluster")?(n(),h(Z,{key:0})):_("",!0)}},Y={__name:"index",setup(e){const o=A();return(e,i)=>{const u=t("router-view");return n(),a(l,null,[r(o).mapLoadStatus?(n(),h(u,{key:0})):_("",!0),s(z,null,{default:c((()=>[r(o).mapLoadStatus?(n(),a(l,{key:0},[s(W),s(H)],64)):_("",!0)])),_:1})],64)}}},K=S({__name:"map3d-base",setup(e){let t;Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyMGZjMTZjMC00YTQ4LTQwODAtOTg5YS1lOWU2NThjMTk0YjMiLCJpZCI6MjExNTEwLCJpYXQiOjE3MTQxMjIzNDZ9.o5yDodfaExKiDdc9mN0N86ybB3l2K4ggAThC3SWURkE";const o=C(null),i=A();return f((async()=>{t=new Cesium.Viewer(o.value,{baseLayerPicker:!0,homeButton:!1,infoBox:!1,fullscreenButton:!1,timeline:!1,animation:!1,geocoder:!1,navigationHelpButton:!1}),window.viewer=t,t._cesiumWidget._creditContainer.style.display="none",t._cesiumWidget._creditContainer&&(t._cesiumWidget._creditContainer.style.display="none"),t.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(114.3,30.59,8e6),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0,distance:1e3}}),function(e){const t=new Cesium.ScreenSpaceEventHandler(e.scene.canvas);t.setInputAction((function(t){e.scene.pick(t.position)}),Cesium.ScreenSpaceEventType.LEFT_CLICK),t.setInputAction((function(t){e.scene.pick(t.endPosition)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE)}(t),i.mapLoadStatus=!0})),w((function(){t&&t.destroy()})),(e,t)=>(n(),a("div",{ref_key:"cesiumContainer",ref:o,class:"cesium-container"},null,512))}},[["__scopeId","data-v-542758d8"]]),Q={class:"map-layout"},X={class:"map-components"},q=S({__name:"map3d-layout",setup:e=>(e,t)=>(n(),a("div",Q,[s(K),o("div",X,[g(e.$slots,"default",{},void 0,!0)])]))},[["__scopeId","data-v-c565f954"]]),$={__name:"Camera",setup(e){const t=A(),{flyPoi:n,flyArea:a}=k(t);return v(n,(e=>{const{x:t,y:n,z:a}=e;t&&n&&a&&viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(t,n,a),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0,distance:1e3}})})),v(a,(e=>{const t=new Cesium.GeoJsonDataSource;t.load(e).then((()=>{viewer.dataSources.add(t);const n=V(e),a=viewer.camera.createFlightPath({destination:n,orientation:{heading:Cesium.Math.toRadians(270),pitch:Cesium.Math.toRadians(-60),roll:0},duration:2});viewer.camera.flyTo(a)}))})),(e,t)=>null}},ee={__name:"CascaderArea3d",setup(e){const t=A();let o=null;return v((()=>t.cascaer_geo_data),(e=>{var n;e&&(o&&((n=o)&&window.viewer.dataSources.remove(n)),o=function(e,n=!0){const a=window.viewer,o=new Cesium.GeoJsonDataSource;let i=new Map;return o.load(e,{clampToGround:!0}).then((n=>{var r;a.dataSources.add(o),o.entities.values.forEach(((e,t)=>{e.polygon.material=Cesium.Color.fromCssColorString("#fff").withAlpha(0),e.polyline={positions:e.polygon.hierarchy._value.positions,width:3,material:Cesium.Color.fromCssColorString("#689fd2")};const n=Cesium.BoundingSphere.fromPoints(e.polygon.hierarchy._value.positions).center,a=e.properties.getValue().name;i.get(a)||(e.label={text:a,color:Cesium.Color.fromCssColorString("#fff"),font:"normal 32px MicroSoft YaHei",showBackground:!0,scale:.5,horizontalOrigin:Cesium.HorizontalOrigin.LEFT_CLICK,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,disableDepthTestDistance:1e4,enableCollisionDetection:!0},i.set(a,1)),e.position=n}));const s=[1e7,1e6,8e5][(null==(r=t.cascader_vmodel)?void 0:r.length)-1],[l,u]=V(e).geometry.coordinates;t.flyPoi={x:l,y:u,z:s}})),o}(e))}),{immediate:!0,deep:!0}),(e,t)=>(n(),a("div"))}},te={__name:"index",setup(e){const o=A();return(e,i)=>{const u=t("router-view");return n(),a(l,null,[r(o).mapLoadStatus?(n(),h(u,{key:0})):_("",!0),s(q,null,{default:c((()=>[s(ee),s($)])),_:1})],64)}}},ne={class:"layout"},ae={class:"layout-header"},oe={class:"layout-content"},ie=S({__name:"Layout",setup(e){const t=A();return(e,i)=>(n(),a("div",ne,[o("div",ae,[s(j)]),o("div",oe,["2d"==r(t).mapMode?(n(),h(Y,{key:0})):_("",!0),"3d"==r(t).mapMode?(n(),h(te,{key:1})):_("",!0)]),s(D)]))}},[["__scopeId","data-v-604494c5"]]);export{ie as default};
