import{c as e,E as t,G as n,v as a,r as o,x as i,k as r,q as s,y as l,H as c,u,F as d,I as p,z as m,J as f,K as y,o as g,L as v,M as h,w as C,l as w,N as _,a as M,O as b,P as S}from"./index-22c5b6f7.js";import{_ as k}from"./_plugin-vue_export-helper-1b428a4d.js";import{u as A}from"./map-a4c8a058.js";const O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"};function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){T(e,t,n[t])}))}return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=function(n,a){var o=I({},n,a.attrs);return e(t,I({},o,{icon:O}),null)};P.displayName="UserOutlined",P.inheritAttrs=!1;const x=P,E={homeTitle:"可视化平台"},L={class:"menu-container"},j={class:"logo"},D={class:"search"},N={class:"menu"},B=["onClick"],G={class:"author"},z=k({__name:"menu",setup(t){const g=n(),v=a(),h=o({current:{},options:[],handleChange(e){}}),C=o({options:[{label:"大屏展示",dataIndex:"isShowLayerManger",route:"/overview"},{label:"图层管理",key:"isShowLayerManger",route:"/layers"}],onClickMenu(e){v.replace({path:e.route})}});return(t,n)=>{const a=i("a-select"),o=i("a-avatar"),v=i("a-badge");return r(),s("div",L,[l("div",j,c(u(E).homeTitle),1),l("div",D,[e(a,{value:u(h).value,"onUpdate:value":n[0]||(n[0]=e=>u(h).value=e),mode:"tags",style:{width:"100%"},placeholder:"请输入",options:u(h).options,onChange:u(h).handleChange},null,8,["value","options","onChange"])]),l("div",N,[(r(!0),s(d,null,p(u(C).options,(e=>(r(),s("div",{class:f(["menu-item",{active:u(g).path===e.route}]),key:e.route,onClick:y((t=>u(C).onClickMenu(e)),["stop"])},c(e.label),11,B)))),128))]),l("div",G,[e(v,{dot:""},{default:m((()=>[e(o,null,{icon:m((()=>[e(u(x))])),_:1})])),_:1})])])}}},[["__scopeId","data-v-853ef434"]]);const J=k({},[["render",function(e,t){return null}]]),F={id:"map-container"},R=k({__name:"map2d-base",props:{id:{type:String,default:"main"}},setup(e){const t=A();return g((async()=>{window.map=await new AMap.Map("map-container",{viewMode:"3D",zoom:4,center:[104.2990125,28.480215434999998],resizeEnable:!0}),map.setMapStyle("amap://styles/dark"),AMap.plugin(["AMap.ToolBar","AMap.Scale","AMap.HawkEye","AMap.MapType","AMap.Geolocation","AMap.ControlBar"],(function(){map.addControl(new AMap.Scale)})),t.contextMenu=new AMap.ContextMenu,map.on("rightclick",(function(e){})),map.on("complete",(function(){t.mapLoadStatus=!0}))})),v((async()=>{map&&map.map.destroy()})),(e,t)=>(r(),s("div",F))}},[["__scopeId","data-v-95f4c934"]]),U={class:"map-layout"},V={class:"map-components"},H=k({__name:"map2d-layout",props:{id:{type:String,default:"main"}},setup:t=>(n,a)=>(r(),s("div",U,[e(R,{id:t.id},null,8,["id"]),l("div",V,[h(n.$slots,"default",{},void 0,!0)])]))},[["__scopeId","data-v-e368c412"]]);function Z(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function K(e,t,n){if(null!==e)for(var a,o,i,r,s,l,c,u,d=0,p=0,m=e.type,f="FeatureCollection"===m,y="Feature"===m,g=f?e.features.length:1,v=0;v<g;v++){s=(u=!!(c=f?e.features[v].geometry:y?e.geometry:e)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var h=0;h<s;h++){var C=0,w=0;if(null!==(r=u?c.geometries[h]:c)){l=r.coordinates;var _=r.type;switch(d=!n||"Polygon"!==_&&"MultiPolygon"!==_?0:1,_){case null:break;case"Point":if(!1===t(l,p,v,C,w))return!1;p++,C++;break;case"LineString":case"MultiPoint":for(a=0;a<l.length;a++){if(!1===t(l[a],p,v,C,w))return!1;p++,"MultiPoint"===_&&C++}"LineString"===_&&C++;break;case"Polygon":case"MultiLineString":for(a=0;a<l.length;a++){for(o=0;o<l[a].length-d;o++){if(!1===t(l[a][o],p,v,C,w))return!1;p++}"MultiLineString"===_&&C++,"Polygon"===_&&w++}"Polygon"===_&&C++;break;case"MultiPolygon":for(a=0;a<l.length;a++){for(w=0,o=0;o<l[a].length;o++){for(i=0;i<l[a][o].length-d;i++){if(!1===t(l[a][o][i],p,v,C,w))return!1;p++}w++}C++}break;case"GeometryCollection":for(a=0;a<r.geometries.length;a++)if(!1===K(r.geometries[a],t,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function W(e){var t=[Infinity,Infinity,-Infinity,-Infinity];return K(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}function Y(e,t){void 0===t&&(t={});var n=W(e);return function(e,t,n){if(void 0===n&&(n={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Z(e[0])||!Z(e[1]))throw new Error("coordinates must contain numbers");return function(e,t,n){void 0===n&&(n={});var a={type:"Feature"};return(0===n.id||n.id)&&(a.id=n.id),n.bbox&&(a.bbox=n.bbox),a.properties=t||{},a.geometry=e,a}({type:"Point",coordinates:e},t,n)}([(n[0]+n[2])/2,(n[1]+n[3])/2],t.properties,t)}W.default=W;const Q=k({__name:"CascaderArea2d",setup(e){const t=A();let n=null;function a(e){!function(e){AMap.plugin("AMap.GeoJSON",(function(){n=new AMap.GeoJSON({zoomToExtent:!0,geoJSON:e,getMarker:function(e,t){const{properties:n}=e;return new AMap.Marker({position:t,offset:new AMap.Pixel(-10,-10),title:null==n?void 0:n.name})},getPolyline:function(e,t){return new AMap.Polyline({path:t})},getPolygon:function(e,n){const a=new AMap.Polygon({path:n,fillOpacity:0,strokeColor:"gray",fillColor:"white",fitView:!0});return a.on("mouseover",(()=>{a.setOptions({fillOpacity:.7,fillColor:"white"})})),a.on("click",(()=>{const n=[...e.properties.acroutes,Number(e.properties.adcode)];n.length>t.cascader_max_level?alert("已达到最大层级"):t.cascader_vmodel=n})),a.on("mouseout",(()=>{a.setOptions({fillOpacity:0,fillColor:"#white"})})),a}}),map.add(n)}))}(e)}return C((()=>t.cascaer_geo_data),(e=>{if(!e)return null==n||n.clearOverlays(),void(n=null);n?n.importData(e):a(e),function(e){if(!e)return;const[t,{lng:n,lat:a}]=map.getFitZoomAndCenterByBounds(W(e));map.setZoomAndCenter(t-.5,[n,a])}(e)}),{immediate:!0,deep:!0}),(e,t)=>null}},[["__scopeId","data-v-a1170bbc"]]),q={__name:"index",setup(t){const n=A();return(t,a)=>{const o=i("router-view");return r(),s(d,null,[u(n).mapLoadStatus?(r(),w(o,{key:0})):_("",!0),e(H,null,{default:m((()=>[u(n).mapLoadStatus?(r(),s(d,{key:0},[u(n).cascader_show_status?(r(),w(Q,{key:0})):_("",!0)],64)):_("",!0)])),_:1})],64)}}},X=k({__name:"map3d-base",setup(e){let t;Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyMGZjMTZjMC00YTQ4LTQwODAtOTg5YS1lOWU2NThjMTk0YjMiLCJpZCI6MjExNTEwLCJpYXQiOjE3MTQxMjIzNDZ9.o5yDodfaExKiDdc9mN0N86ybB3l2K4ggAThC3SWURkE";const n=M(null),a=A();return g((async()=>{t=new Cesium.Viewer(n.value,{baseLayerPicker:!0,homeButton:!1,infoBox:!1,fullscreenButton:!1,timeline:!1,animation:!1,geocoder:!1,navigationHelpButton:!1}),window.viewer=t,t._cesiumWidget._creditContainer.style.display="none",t._cesiumWidget._creditContainer&&(t._cesiumWidget._creditContainer.style.display="none"),t.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(114.3,30.59,8e6),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0,distance:1e3}}),function(e){const t=new Cesium.ScreenSpaceEventHandler(e.scene.canvas);t.setInputAction((function(t){e.scene.pick(t.position)}),Cesium.ScreenSpaceEventType.LEFT_CLICK),t.setInputAction((function(t){e.scene.pick(t.endPosition)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE)}(t),a.mapLoadStatus=!0})),b((function(){t&&t.destroy()})),(e,t)=>(r(),s("div",{ref_key:"cesiumContainer",ref:n,class:"cesium-container"},null,512))}},[["__scopeId","data-v-65e90961"]]),$={class:"map-layout"},ee={class:"map-components"},te=k({__name:"map3d-layout",setup:t=>(t,n)=>(r(),s("div",$,[e(X),l("div",ee,[h(t.$slots,"default",{},void 0,!0)])]))},[["__scopeId","data-v-c565f954"]]),ne={__name:"Camera",setup(e){const t=A(),{flyPoi:n,flyArea:a}=S(t);return C(n,(e=>{const{x:t,y:n,z:a}=e;t&&n&&a&&viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(t,n,a),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0,distance:1e3}})})),C(a,(e=>{const t=new Cesium.GeoJsonDataSource;t.load(e).then((()=>{viewer.dataSources.add(t);const n=Y(e),a=viewer.camera.createFlightPath({destination:n,orientation:{heading:Cesium.Math.toRadians(270),pitch:Cesium.Math.toRadians(-60),roll:0},duration:2});viewer.camera.flyTo(a)}))})),(e,t)=>null}},ae={__name:"CascaderArea3d",setup(e){const t=A();let n=null;return C((()=>t.cascaer_geo_data),(e=>{var a;e&&(n&&((a=n)&&window.viewer.dataSources.remove(a)),n=function(e,n=!0){const a=window.viewer,o=new Cesium.GeoJsonDataSource;let i=new Map;return o.load(e,{clampToGround:!0}).then((n=>{var r;a.dataSources.add(o),o.entities.values.forEach(((e,t)=>{e.polygon.material=Cesium.Color.fromCssColorString("#fff").withAlpha(0),e.polyline={positions:e.polygon.hierarchy._value.positions,width:3,material:Cesium.Color.fromCssColorString("#689fd2")};const n=Cesium.BoundingSphere.fromPoints(e.polygon.hierarchy._value.positions).center,a=e.properties.getValue().name;i.get(a)||(e.label={text:a,color:Cesium.Color.fromCssColorString("#fff"),font:"normal 32px MicroSoft YaHei",showBackground:!0,scale:.5,horizontalOrigin:Cesium.HorizontalOrigin.LEFT_CLICK,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,disableDepthTestDistance:1e4,enableCollisionDetection:!0},i.set(a,1)),e.position=n}));const s=[1e7,1e6,8e5][(null==(r=t.cascader_vmodel)?void 0:r.length)-1],[l,c]=Y(e).geometry.coordinates;t.flyPoi={x:l,y:c,z:s}})),o}(e))}),{immediate:!0,deep:!0}),(e,t)=>(r(),s("div"))}},oe={__name:"index",setup(t){const n=A();return(t,a)=>{const o=i("router-view");return r(),s(d,null,[u(n).mapLoadStatus?(r(),w(o,{key:0})):_("",!0),e(te,null,{default:m((()=>[e(ae),e(ne)])),_:1})],64)}}},ie={class:"layout"},re={class:"layout-header"},se={class:"layout-content"},le=k({__name:"layout",setup(t){const n=A();return(t,a)=>(r(),s("div",ie,[l("div",re,[e(z)]),l("div",se,["2d"==u(n).mapMode?(r(),w(q,{key:0})):_("",!0),"3d"==u(n).mapMode?(r(),w(oe,{key:1})):_("",!0)]),e(J)]))}},[["__scopeId","data-v-283c377e"]]);export{le as default};
